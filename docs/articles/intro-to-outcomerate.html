<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intro to outcomerate • outcomerate</title>
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Intro to outcomerate">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">outcomerate</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro-to-outcomerate.html">Intro to outcomerate</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/outcomerate">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Intro to outcomerate</h1>
                        <h4 class="author">Rafael Pilliard Hellwig</h4>
            
            <h4 class="date">2018-10-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/outcomerate/blob/master/vignettes/intro-to-outcomerate.Rmd"><code>vignettes/intro-to-outcomerate.Rmd</code></a></small>
      <div class="hidden name"><code>intro-to-outcomerate.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates the basic applications of the <code>outcomerate</code> package in R. I will draw on the popular <code>tidyverse</code> family of packages for the analysis.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># load packages</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(outcomerate)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(knitr)</a></code></pre></div>
<p>To keep things lighthearted, I will use a toy dataset named <code>middleearth</code>. The data consists of 1691 rows, each representing an attempt to interview a member of middle earth. Not all elements in the sample resulted in a completed interview, however. Some cases could not be located, others were located but no one was available, some individuals were found but refused to participate, etc. These particular ‘dispositions’ can be summarized from the <code>code</code> variable in the data:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># load dataset</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">data</span>(middleearth)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co"># tabulate frequency table of outcomes</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="kw"><a href="http://dplyr.tidyverse.org/reference/tally.html">count</a></span>(middleearth, code, outcome))</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">code</th>
<th align="left">outcome</th>
<th align="right">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">NE</td>
<td align="left">Not eligible</td>
<td align="right">71</td>
</tr>
<tr class="even">
<td align="left">I</td>
<td align="left">Complete interview</td>
<td align="right">760</td>
</tr>
<tr class="odd">
<td align="left">P</td>
<td align="left">Partial interview</td>
<td align="right">339</td>
</tr>
<tr class="even">
<td align="left">R</td>
<td align="left">Refusal and break-off</td>
<td align="right">59</td>
</tr>
<tr class="odd">
<td align="left">NC</td>
<td align="left">Non-contact</td>
<td align="right">288</td>
</tr>
<tr class="even">
<td align="left">UO</td>
<td align="left">Unlocated</td>
<td align="right">173</td>
</tr>
<tr class="odd">
<td align="left">O</td>
<td align="left">Other</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>It is common for survey practitioners to report a number of outcome rates. These rates give an indication as to the quality of the field work. For example, you may want to know the response rate: the proportion of all cases from our intended sample that actually resulted in an interview.</p>
<p>How might we go about calculating this?</p>
<p>When we inspect our disposition codes, it become apparent that there could be several ways to do this. For example, you may start by using the total number of complete cases (760) and diving this by the number of observations in the data, 760 / 1691 = 0.45. But what about partially completed interviews? If you include those, you would get a rate of (760 + 339) / 1691 = 0.65.</p>
<p>It turns out that there are a lot of ways to calculate such outcome rates. Unless we specify exactly what we mean by “response rate”, it is easy for claims regarding survey quality to become opaque, lacking comparability with other surveys. For this reason, the American Association for Public Opinion Research (AAPOR) has published a <a href="https://www.aapor.org/Standards-Ethics/Standard-Definitions-(1).aspx">set of standardized definitions</a> for practitioners. The guide has no fewer than 6 different variants of the ‘response rate.’ In the our example, the rates we calculated would match to AAPOR’s “Response Rate 1” and “Response Rate 2”:</p>
<p><span class="math display">\[
\textrm{RR1} = \frac{\textrm{I}}{\textrm{(I + P) + R + O + NC + (UO + UH)}} 
= \frac{760}{(760 + 339) + 59 + 1 + 288 + (173 + 0)} 
= 0.47
\]</span></p>
<p><span class="math display">\[
\textrm{RR2} = \frac{\textrm{(I + P)}}{\textrm{(I + P) + R + O + NC + (UO + UH)}} 
= \frac{(760 + 339)}{(760 + 339) + 59 + 1 + 288 + (173 + 0)} 
= 0.68
\]</span></p>
<p>What’s more, the guide has multiple definitions for contact rates, refusal rates, and cooperation rates, and weighted rates. It can easily become tedious to look all these up and calculate them by hand. The <code>outcomerate</code> package makes it easier by giving all rates (and more) in one go:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">disp_counts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">I =</span> <span class="dv">760</span>, <span class="dt">P =</span> <span class="dv">339</span>, <span class="dt">R =</span> <span class="dv">59</span>, <span class="dt">NC =</span> <span class="dv">288</span>, <span class="dt">O =</span> <span class="dv">1</span>, <span class="dt">UO =</span> <span class="dv">173</span>, <span class="dt">NE =</span> <span class="dv">71</span>) </a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">e &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eligibility_rate.html">eligibility_rate</a></span>(disp_counts)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="../reference/outcomerate.html">outcomerate</a></span>(disp_counts, <span class="dt">e =</span> e)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;        RR1        RR2        RR3        RR4        RR5        RR6 </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; 0.46913580 0.67839506 0.47149080 0.68180052 0.52522460 0.75950242 </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;      COOP1      COOP2      COOP3      COOP4       REF1       REF2 </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; 0.65573770 0.94823123 0.65630397 0.94905009 0.03641975 0.03660258 </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;       REF3       CON1       CON2       CON3       LOC1       LOC2 </span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; 0.04077402 0.71543210 0.71902347 0.80096752 0.89320988 0.89769367</span></a></code></pre></div>
<p>Each of these rates has a precise definition (see <code><a href="../reference/outcomerate.html">?outcomerate</a></code> for details). As we can see, <code>RR1</code> and <code>RR2</code> match our earlier calculations. In the example, I needed to specify the parameter <code>e</code>, the estimated proportion of unknown cases unknowns (<code>UO</code>) that were eligible. The <code><a href="../reference/eligibility_rate.html">eligibility_rate()</a></code> offers a default way to calculate this, but others may be appropriate.</p>
<p>If we had wanted just to return the two rates from above, we could specify this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/outcomerate.html">outcomerate</a></span>(disp_counts, <span class="dt">rate =</span> <span class="kw">c</span>(<span class="st">"RR1"</span>, <span class="st">"RR2"</span>))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt;       RR1       RR2 </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; 0.4691358 0.6783951</span></a></code></pre></div>
<div id="more-advanced-uses" class="section level2">
<h2 class="hasAnchor">
<a href="#more-advanced-uses" class="anchor"></a>More Advanced Uses</h2>
<p>In certain situations, you may want to calculate outcome rates based on a vector of codes, rather than a table of frequency counts. It is just as easy to obtain rates this way using <code>outcomerate</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># print the head of the dataset</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">head</span>(middleearth)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; # A tibble: 6 x 9</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;   code  outcome          researcher region   Q1       Q2   day race  svywt</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt;   &lt;ord&gt; &lt;ord&gt;            &lt;chr&gt;      &lt;fct&gt;    &lt;fct&gt; &lt;int&gt; &lt;int&gt; &lt;fct&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 1 UO    Unlocated        #23        Beleria… &lt;NA&gt;     NA     1 Elf      32</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 2 I     Complete interv… #23        Beleria… No        7     1 Hobb…    52</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; 3 I     Complete interv… #23        Beleria… No        7     1 Hobb…    52</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; 4 P     Partial intervi… #13        Beleria… No        7     1 Hobb…    52</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; 5 NE    Not eligible     #50        Beleria… &lt;NA&gt;     NA     1 Man      85</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; 6 I     Complete interv… #23        Beleria… No        7     1 Man      85</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co"># calculate rates using codes; should be same result as before</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="kw"><a href="../reference/outcomerate.html">outcomerate</a></span>(middleearth<span class="op">$</span>code, <span class="dt">e =</span> e)</a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;        RR1        RR2        RR3        RR4        RR5        RR6 </span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt; 0.46913580 0.67839506 0.47149080 0.68180052 0.52522460 0.75950242 </span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt;      COOP1      COOP2      COOP3      COOP4       REF1       REF2 </span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; 0.65573770 0.94823123 0.65630397 0.94905009 0.03641975 0.03660258 </span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt;       REF3       CON1       CON2       CON3       LOC1       LOC2 </span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; 0.04077402 0.71543210 0.71902347 0.80096752 0.89320988 0.89769367</span></a></code></pre></div>
<p>Why might we prefer this input format, when it is just as easy to specify the counts?</p>
<p>Well, if we want to calculate outcome rates by some other covariate, we typically need to go back to the original data. For example, here we use <code>dplyr</code> and <code>tidyr</code> to calculate outcome rates of interest by race:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># create a small wrapper function</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">get_rates &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...){</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  rlist &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"RR1"</span>, <span class="st">"RR2"</span>, <span class="st">"COOP1"</span>, <span class="st">"COOP2"</span>, <span class="st">"CON1"</span>, <span class="st">"REF1"</span>, <span class="st">"LOC1"</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="kw">as.data.frame</span>(<span class="kw">as.list</span>(<span class="kw"><a href="../reference/outcomerate.html">outcomerate</a></span>(x, <span class="dt">rate =</span> rlist, <span class="dt">e =</span> e, ...)))</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co"># calculate rates by group</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">middleearth <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(race) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">n     =</span> <span class="kw"><a href="http://dplyr.tidyverse.org/reference/n.html">n</a></span>(),</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">            <span class="dt">Nhat  =</span> <span class="kw">sum</span>(svywt),</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">            <span class="dt">rates =</span> <span class="kw">list</span>(<span class="kw">get_rates</span>(code))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/unnest">unnest</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">caption =</span> <span class="st">"Outcome Rates by Race"</span>)</a></code></pre></div>
<table class="table">
<caption>Outcome Rates by Race</caption>
<thead><tr class="header">
<th align="left">race</th>
<th align="right">n</th>
<th align="right">Nhat</th>
<th align="right">RR1</th>
<th align="right">RR2</th>
<th align="right">COOP1</th>
<th align="right">COOP2</th>
<th align="right">CON1</th>
<th align="right">REF1</th>
<th align="right">LOC1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Dwarf</td>
<td align="right">376</td>
<td align="right">5640</td>
<td align="right">0.29</td>
<td align="right">0.35</td>
<td align="right">0.78</td>
<td align="right">0.95</td>
<td align="right">0.37</td>
<td align="right">0.02</td>
<td align="right">0.92</td>
</tr>
<tr class="even">
<td align="left">Elf</td>
<td align="right">251</td>
<td align="right">8032</td>
<td align="right">0.08</td>
<td align="right">0.33</td>
<td align="right">0.21</td>
<td align="right">0.87</td>
<td align="right">0.38</td>
<td align="right">0.05</td>
<td align="right">0.41</td>
</tr>
<tr class="odd">
<td align="left">Hobbit</td>
<td align="right">404</td>
<td align="right">21008</td>
<td align="right">0.41</td>
<td align="right">0.86</td>
<td align="right">0.45</td>
<td align="right">0.94</td>
<td align="right">0.91</td>
<td align="right">0.05</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">Man</td>
<td align="right">659</td>
<td align="right">56015</td>
<td align="right">0.76</td>
<td align="right">0.89</td>
<td align="right">0.82</td>
<td align="right">0.97</td>
<td align="right">0.92</td>
<td align="right">0.03</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">Wizard</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
<div id="weighted-outcome-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#weighted-outcome-rates" class="anchor"></a>Weighted Outcome Rates</h3>
<p>In certain situations, we also wish to produce <em>weighted</em> outcome rates, using the survey weights that are provided in the data. This is easy to do with one additional parameter:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># calculate weighted rates by group</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">middleearth <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(region) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">n     =</span> <span class="kw"><a href="http://dplyr.tidyverse.org/reference/n.html">n</a></span>(),</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">            <span class="dt">Nhat  =</span> <span class="kw">sum</span>(svywt),</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">            <span class="dt">rates =</span> <span class="kw">list</span>(<span class="kw">get_rates</span>(code, <span class="dt">weight =</span> svywt))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/unnest">unnest</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(<span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">caption =</span> <span class="st">"Weighted Outcome Rates by Region"</span>)</a></code></pre></div>
<table class="table">
<caption>Weighted Outcome Rates by Region</caption>
<thead><tr class="header">
<th align="left">region</th>
<th align="right">n</th>
<th align="right">Nhat</th>
<th align="right">RR1w</th>
<th align="right">RR2w</th>
<th align="right">COOP1w</th>
<th align="right">COOP2w</th>
<th align="right">CON1w</th>
<th align="right">REF1w</th>
<th align="right">LOC1w</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Beleriand</td>
<td align="right">415</td>
<td align="right">21579</td>
<td align="right">0.51</td>
<td align="right">0.75</td>
<td align="right">0.62</td>
<td align="right">0.91</td>
<td align="right">0.83</td>
<td align="right">0.07</td>
<td align="right">0.93</td>
</tr>
<tr class="even">
<td align="left">Rhun</td>
<td align="right">195</td>
<td align="right">9637</td>
<td align="right">0.55</td>
<td align="right">0.72</td>
<td align="right">0.74</td>
<td align="right">0.96</td>
<td align="right">0.75</td>
<td align="right">0.03</td>
<td align="right">0.92</td>
</tr>
<tr class="odd">
<td align="left">Eriador</td>
<td align="right">564</td>
<td align="right">29794</td>
<td align="right">0.64</td>
<td align="right">0.83</td>
<td align="right">0.75</td>
<td align="right">0.98</td>
<td align="right">0.85</td>
<td align="right">0.02</td>
<td align="right">0.94</td>
</tr>
<tr class="even">
<td align="left">Rhovanion</td>
<td align="right">306</td>
<td align="right">17830</td>
<td align="right">0.61</td>
<td align="right">0.85</td>
<td align="right">0.69</td>
<td align="right">0.96</td>
<td align="right">0.89</td>
<td align="right">0.03</td>
<td align="right">0.96</td>
</tr>
<tr class="odd">
<td align="left">Harad</td>
<td align="right">211</td>
<td align="right">11858</td>
<td align="right">0.60</td>
<td align="right">0.79</td>
<td align="right">0.74</td>
<td align="right">0.96</td>
<td align="right">0.82</td>
<td align="right">0.03</td>
<td align="right">0.95</td>
</tr>
</tbody>
</table>
<p>Compare this to the equivalent unweighted estimates, and you see that the results are not the same.</p>
<table class="table">
<caption>Unweighted Outcome Rates by Region</caption>
<thead><tr class="header">
<th align="left">region</th>
<th align="right">n</th>
<th align="right">Nhat</th>
<th align="right">RR1</th>
<th align="right">RR2</th>
<th align="right">COOP1</th>
<th align="right">COOP2</th>
<th align="right">CON1</th>
<th align="right">REF1</th>
<th align="right">LOC1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Beleriand</td>
<td align="right">415</td>
<td align="right">21579</td>
<td align="right">0.39</td>
<td align="right">0.62</td>
<td align="right">0.56</td>
<td align="right">0.89</td>
<td align="right">0.70</td>
<td align="right">0.07</td>
<td align="right">0.87</td>
</tr>
<tr class="even">
<td align="left">Rhun</td>
<td align="right">195</td>
<td align="right">9637</td>
<td align="right">0.41</td>
<td align="right">0.55</td>
<td align="right">0.71</td>
<td align="right">0.96</td>
<td align="right">0.57</td>
<td align="right">0.02</td>
<td align="right">0.87</td>
</tr>
<tr class="odd">
<td align="left">Eriador</td>
<td align="right">564</td>
<td align="right">29794</td>
<td align="right">0.51</td>
<td align="right">0.70</td>
<td align="right">0.71</td>
<td align="right">0.97</td>
<td align="right">0.72</td>
<td align="right">0.02</td>
<td align="right">0.89</td>
</tr>
<tr class="even">
<td align="left">Rhovanion</td>
<td align="right">306</td>
<td align="right">17830</td>
<td align="right">0.53</td>
<td align="right">0.78</td>
<td align="right">0.65</td>
<td align="right">0.96</td>
<td align="right">0.81</td>
<td align="right">0.03</td>
<td align="right">0.93</td>
</tr>
<tr class="odd">
<td align="left">Harad</td>
<td align="right">211</td>
<td align="right">11858</td>
<td align="right">0.50</td>
<td align="right">0.70</td>
<td align="right">0.68</td>
<td align="right">0.95</td>
<td align="right">0.73</td>
<td align="right">0.03</td>
<td align="right">0.90</td>
</tr>
</tbody>
</table>
</div>
<div id="by-date" class="section level3">
<h3 class="hasAnchor">
<a href="#by-date" class="anchor"></a>By Date</h3>
<p>Lastly, another useful application of grouped analysis is to calculate the rates by date. This allows you to monitor the quality day by day and notice if performance starts to change over time.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co"># day-by-day quality monitoring</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">middleearth <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(day) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(<span class="dt">rates =</span> <span class="kw">list</span>(<span class="kw">get_rates</span>(code))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/unnest">unnest</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/gather">gather</a></span>(rate, value, <span class="op">-</span>day) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">type =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/stringr/topics/str_sub">str_sub</a></span>(rate, <span class="dt">start =</span> <span class="dv">-9</span>, <span class="dt">end =</span> <span class="dv">-2</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> day, <span class="dt">y =</span> value, <span class="dt">colour =</span> rate)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>type) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Outcome Rates Over Time"</span>)</a></code></pre></div>
<p><img src="intro-to-outcomerate_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>In this example, we can see that the contact rate (<code>CON</code>) and response rate (<code>RR</code>) start to degrade in quality towards day 30. If fieldwork was still continuing, this could be something to look into and attempt to explain and/or redress.</p>
</div>
</div>
<div id="variance-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#variance-estimation" class="anchor"></a>Variance Estimation</h2>
<p>To estimate the errors from estimates generated by <code><a href="../reference/outcomerate.html">outcomerate()</a></code>, the simplest approach is to use the normal appromation. Since outcome rates are nothing more than proportions (or nearly so), their standard error is given by <span class="math inline">\(SE(p) = \sqrt{(p(1-p))/n}\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># first, calculate the outcome rates</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">(res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/outcomerate.html">outcomerate</a></span>(middleearth<span class="op">$</span>code))</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt;        RR1        RR2        RR5        RR6      COOP1      COOP2 </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; 0.46913580 0.67839506 0.52522460 0.75950242 0.65573770 0.94823123 </span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;      COOP3      COOP4       REF1       REF3       CON1       CON3 </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; 0.65630397 0.94905009 0.03641975 0.04077402 0.71543210 0.80096752 </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt;       LOC1 </span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; 0.89320988</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co"># estimate standard errors using the Normal approximation for proportions </span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">se &lt;-<span class="st"> </span><span class="kw">sapply</span>(res, <span class="cf">function</span>(p) <span class="kw">sqrt</span>((p <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p)) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(middleearth)))</a></code></pre></div>
<p>With the standard error in hand, we can then construct frequentist confidence intervals:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># calculate 95% confidence intervals</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">rbind</span>(res <span class="op">-</span><span class="st"> </span>(se <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span>), res <span class="op">+</span><span class="st"> </span>(se <span class="op">*</span><span class="st"> </span><span class="fl">1.96</span>))</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;            RR1       RR2       RR5       RR6     COOP1     COOP2     COOP3</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; [1,] 0.4453496 0.6561319 0.5014233 0.7391318 0.6330916 0.9376710 0.6336667</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; [2,] 0.4929220 0.7006582 0.5490259 0.7798730 0.6783838 0.9587915 0.6789412</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt;          COOP4       REF1       REF3      CON1      CON3      LOC1</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; [1,] 0.9385691 0.02749088 0.03134782 0.6939260 0.7819369 0.8784892</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; [2,] 0.9595310 0.04534863 0.05020021 0.7369382 0.8199982 0.9079305</span></a></code></pre></div>
<p>Weighted variance estimation in complex surveys require different procedures that go beyond the scope of this vignette. We recommend using <code>svycontrast()</code> from the <code>survey</code> package to obtain design-based errors that account for elements such as clustering and stratification. Bootstrapping primary sampling units (PSUs) may also be an appropriate method depending on the design at hand.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#more-advanced-uses">More Advanced Uses</a></li>
      <li><a href="#variance-estimation">Variance Estimation</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Rafael Pilliard Hellwig.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
